<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Overlapping Stacked Plots â€¢ ggstackplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Create Overlapping Stacked Plots">
<meta property="og:description" content="Easily create overlapping grammar of graphics plots for scientific data visualization. This style of plotting is particularly common in climatology and oceanography research communities.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ggstackplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/explore.html">Explore</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kopflab/ggstackplot" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">

<!-- badges: start -->

<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>Have you ever wanted to create (partly) overlapping line plots with matched color-coding of the data and axes? These kinds of plots are common, for example, in climatology and oceanography research but there is not an easy way to create them with ggplot facets. The ggstackplot package builds on <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a> to provide a straightforward approach to building these kinds of plots while retaining the powerful grammar of graphics functionality of ggplots.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the current release from <a href="https://cran.r-project.org/package=ggstackplot" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggstackplot"</span>)</span></code></pre></div>
<p>You can also install the development version of ggstackplot from <a href="https://github.com/KopfLab/ggstackplot" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># install.packages("pak")</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>pak<span class="sc">::</span><span class="fu">pak</span>(<span class="st">"KopfLab/ggstackplot"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="show-me-some-code">Show me some code<a class="anchor" aria-label="anchor" href="#show-me-some-code"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggstackplot.kopflab.org/">ggstackplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using R's built-in mtcars dataset</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    <span class="co"># define shared x axis</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, </span>
<span>    <span class="co"># define multiple y axes</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weight"</span> <span class="op">=</span> <span class="va">wt</span>, <span class="st">"horsepower"</span> <span class="op">=</span> <span class="va">hp</span><span class="op">)</span>,</span>
<span>    <span class="co"># set colors</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    <span class="co"># set to complete overlap</span></span>
<span>    overlap <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-mtcars-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="show-me-some-climate-data">Show me some climate data<a class="anchor" aria-label="anchor" href="#show-me-some-climate-data"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download a recent dataset from the public climate data repository PANGAEA</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">pangaear</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/pangaear/reference/pg_data.html" class="external-link">pg_data</a></span><span class="op">(</span>doi <span class="op">=</span> <span class="st">"10.1594/PANGAEA.967047"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># show what some of these data look like</span></span>
<span><span class="va">dataset</span><span class="op">$</span><span class="va">data</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Depth ice/snow [m] (Top Depth)"</span>, </span>
<span>    <span class="st">"Age [ka BP]"</span>, </span>
<span>    <span class="st">"[SO4]2- [ng/g] (Ion chromatography)"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="37%">
<col width="16%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="right">Depth ice/snow [m] (Top Depth)</th>
<th align="right">Age [ka BP]</th>
<th align="right">[SO4]2- [ng/g] (Ion chromatography)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">160.215</td>
<td align="right">1.20662</td>
<td align="right">52.00</td>
</tr>
<tr class="even">
<td align="right">160.183</td>
<td align="right">1.20300</td>
<td align="right">165.00</td>
</tr>
<tr class="odd">
<td align="right">160.151</td>
<td align="right">1.20276</td>
<td align="right">93.50</td>
</tr>
<tr class="even">
<td align="right">160.022</td>
<td align="right">1.20191</td>
<td align="right">42.25</td>
</tr>
<tr class="odd">
<td align="right">159.990</td>
<td align="right">1.20155</td>
<td align="right">74.50</td>
</tr>
<tr class="even">
<td align="right">159.958</td>
<td align="right">1.20130</td>
<td align="right">104.50</td>
</tr>
</tbody>
</table>
<p><strong>These data were kindly made available on <a href="https://doi.org/10.1594/PANGAEA.967047" class="external-link">PANGEA</a> by Sigl et al.Â (2024).</strong></p>
<p>Full citation:</p>
<blockquote>
<p>Sigl, Michael; Gabriel, Imogen; Hutchison, William; Burke, Andrea (2024): Sulfate concentration and sulfur isotope data from Greenland TUNU2013 ice-core samples between 740-765 CE [dataset]. PANGAEA, <a href="https://doi.org/10.1594/PANGAEA.967047" class="external-link uri">https://doi.org/10.1594/PANGAEA.967047</a></p>
</blockquote>
<p>Vertical stack plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the data with ggstackplot</span></span>
<span><span class="va">dataset</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Age [ka BP]"</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="co"># vertical stack of the measurements through time</span></span>
<span>      <span class="st">"sulfate [ng/g]"</span> <span class="op">=</span> <span class="st">"[SO4]2- [ng/g] (Ion chromatography)"</span>,</span>
<span>      <span class="st">"Î´34S [â€°]"</span> <span class="op">=</span> <span class="st">"Î´34S [SO4]2- [â€° CDT] (Multi-collector ICP-MS (MC-IC...)"</span>,</span>
<span>      <span class="st">"Î”33S [â€°]"</span> <span class="op">=</span> <span class="st">"Î”33S [SO4]2- [â€° CDT] (Multi-collector ICP-MS (MC-IC...)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># color palette</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    <span class="co"># partial overlap of the panels</span></span>
<span>    overlap <span class="op">=</span> <span class="fl">0.4</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-geodata-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="what-about-horizontal-stacks">What about horizontal stacks?<a class="anchor" aria-label="anchor" href="#what-about-horizontal-stacks"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download some more data from PANGAEA</span></span>
<span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu">pangaear</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/pangaear/reference/pg_data.html" class="external-link">pg_data</a></span><span class="op">(</span>doi <span class="op">=</span> <span class="st">"10.1594/PANGAEA.933277"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># show what some of these data look like</span></span>
<span><span class="va">dataset2</span><span class="op">$</span><span class="va">data</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Depth sed [m]"</span>, <span class="st">"Comp"</span>, <span class="st">"Î´13C [â€° PDB] (mean, vs. VPDB)"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Depth sed [m]</th>
<th align="left">Comp</th>
<th align="right">Î´13C [â€° PDB] (mean, vs.Â VPDB)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">120.205</td>
<td align="left">C17</td>
<td align="right">-28.185</td>
</tr>
<tr class="even">
<td align="right">120.205</td>
<td align="left">phytane</td>
<td align="right">-27.032</td>
</tr>
<tr class="odd">
<td align="right">120.205</td>
<td align="left">C19</td>
<td align="right">-28.268</td>
</tr>
<tr class="even">
<td align="right">120.205</td>
<td align="left">C21</td>
<td align="right">-27.901</td>
</tr>
<tr class="odd">
<td align="right">120.205</td>
<td align="left">C27aaa20R</td>
<td align="right">-29.707</td>
</tr>
<tr class="even">
<td align="right">120.205</td>
<td align="left">C28aaa20R</td>
<td align="right">-28.194</td>
</tr>
</tbody>
</table>
<p>Full citation:</p>
<blockquote>
<p>Boudinot, F Garrett; Kopf, Sebastian; Dildar, Nadia; SepÃºlveda, Julio (2021): Compound-specific carbon isotope results from the SH#1 core analyzed and processed at University of Colorado Boulder [dataset]. PANGAEA, <a href="https://doi.org/10.1594/PANGAEA.933277" class="external-link uri">https://doi.org/10.1594/PANGAEA.933277</a></p>
</blockquote>
<p>Horizontal stack plot:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use a custom template for this plot</span></span>
<span><span class="va">my_template</span> <span class="op">&lt;-</span></span>
<span>  <span class="co"># it's a ggplot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># use a path plot for all (to connect the data points by depth!)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># we still want the default stackplot theme</span></span>
<span>  <span class="fu"><a href="reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># depth is commonly plotted in reverse</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now make the horizontal stack through depth for 2 of the variables</span></span>
<span><span class="va">dataset2</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Comp</span> <span class="op">==</span> <span class="st">"C19"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">`Depth sed [m]`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Î´13C carb [â€° PDB]"</span>,</span>
<span>      <span class="st">"Î´13C n-C19 [â€°]"</span> <span class="op">=</span> <span class="st">"Î´13C [â€° PDB] (mean, vs. VPDB)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Depth sed [m]"</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    template <span class="op">=</span> <span class="va">my_template</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-geodata-horizontal-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or show them side by side (note that this could also be achieved with</span></span>
<span><span class="co"># ggplot facets except for the fine-control and coloring of the different x-axes)</span></span>
<span><span class="va">dataset2</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Comp</span> <span class="op">==</span> <span class="st">"C19"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">`Depth sed [m]`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Î´13C carb [â€° PDB]"</span>,</span>
<span>      <span class="st">"Î´13C n-C19 [â€°]"</span> <span class="op">=</span> <span class="st">"Î´13C [â€° PDB] (mean, vs. VPDB)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Depth sed [m]"</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    <span class="co"># no more overlap</span></span>
<span>    overlap <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    <span class="co"># fine-tune the axes to be on top and bottom</span></span>
<span>    both_axes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    template <span class="op">=</span> <span class="va">my_template</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-geodata-horizontal-2-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="show-me-more">Show me more<a class="anchor" aria-label="anchor" href="#show-me-more"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using the built-in economics dataset in ggplot2 to create a vertical stacke of</span></span>
<span><span class="co"># double axis plots using many of the customization features available with </span></span>
<span><span class="co"># ggstackplot and ggplot2</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/economics.html" class="external-link">economics</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    <span class="co"># define shared x axis</span></span>
<span>    x <span class="op">=</span> <span class="va">date</span>, </span>
<span>    <span class="co"># define the stacked y axes</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pce</span>, <span class="va">pop</span>, <span class="va">psavert</span>, <span class="va">unemploy</span><span class="op">)</span>,</span>
<span>    <span class="co"># pick the RColorBrewer Dark2 palette (good color contrast)</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    <span class="co"># overlay the pce &amp; pop plots (1), then make a full break (0) to the once</span></span>
<span>    <span class="co"># again overlaye psavert &amp; unemploy plots (1)</span></span>
<span>    overlap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># switch axes so unemploy and psavert are on the side where they are </span></span>
<span>    <span class="co"># highest, respectively - not doing this here by changing the order of y</span></span>
<span>    <span class="co"># because we want pop and unemploy on the same side</span></span>
<span>    switch_axes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># make shared axis space a bit smaller</span></span>
<span>    shared_axis_size <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    <span class="co"># provide a base plot with shared graphics eelements among all plots</span></span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="co"># it's a ggplot</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># use a line plot for all</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># we want the default stackplot theme</span></span>
<span>      <span class="fu"><a href="reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># add custom theme modifications, such as text size</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># make the shared axis a date axis</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span><span class="st">"year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># include y=0 for all plots to contextualize data better</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="co"># add plot specific elements</span></span>
<span>    add <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        pce <span class="op">=</span> </span>
<span>          <span class="co"># show pce in trillions of dollars</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"personal consumption expenditures"</span>, </span>
<span>            <span class="co"># always keep the secondary axis duplicated so ggstackplot can</span></span>
<span>            <span class="co"># manage axis placement for you</span></span>
<span>            sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            <span class="co"># labeling function for the dollar units</span></span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"$%.1f T"</span>, <span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>          <span class="op">)</span>,</span>
<span>        pop <span class="op">=</span> </span>
<span>          <span class="co"># show population in millions</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"population"</span>, sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.0f M"</span>, <span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>        psavert <span class="op">=</span> </span>
<span>          <span class="co"># savings is in %</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"personal savings rate"</span>, sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>          <span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="co"># show data points in addition to line</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        unemploy <span class="op">=</span> </span>
<span>          <span class="co"># unemploy in millions</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"unemployed persons"</span>, sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.0f M"</span>, <span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>          <span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="co"># show data points in addition to line</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-economics-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="what-else-can-i-do-with-ggstackplot">What else can I do with ggstackplot?<a class="anchor" aria-label="anchor" href="#what-else-can-i-do-with-ggstackplot"></a>
</h2>
<ul>
<li>check out our <strong><a href="https://ggstackplot.kopflab.org/articles/explore.html">Vignette</a></strong> to explore the package further with detailed examples for all the different features</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggstackplot" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/kopflab/ggstackplot/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kopflab/ggstackplot/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggstackplot</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sebastian Kopf <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-2044-0201" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Tristan Caro <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-6177-7444" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Jamie McFarlin <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8185-8185" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Jon Raberg <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2959-3631" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Sebastian Kopf, Tristan Caro, Jamie McFarlin, Jon Raberg.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
