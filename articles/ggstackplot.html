<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ggstackplot • ggstackplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ggstackplot">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-J5NKSWDWXF"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J5NKSWDWXF');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggstackplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ggstackplot.html">Explore</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kopflab/ggstackplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ggstackplot</h1>
            
            <h4 data-toc-skip class="date">2025-01-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kopflab/ggstackplot/blob/main/vignettes/ggstackplot.Rmd" class="external-link"><code>vignettes/ggstackplot.Rmd</code></a></small>
      <div class="d-none name"><code>ggstackplot.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggstackplot.kopflab.org/">ggstackplot</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette explores the various features of the ggstackplot
package.</p>
<div class="section level2">
<h2 id="main-arguments">Main Arguments<a class="anchor" aria-label="anchor" href="#main-arguments"></a>
</h2>
<div class="section level3">
<h3 id="x-and-y-arguments">
<code>x</code> and <code>y</code> arguments<a class="anchor" aria-label="anchor" href="#x-and-y-arguments"></a>
</h3>
<div class="section level4">
<h4 id="vertical-stack">Vertical stack<a class="anchor" aria-label="anchor" href="#vertical-stack"></a>
</h4>
<p>Select variables to make a stack. The selection order translates to
the order with which the plots are stacked. Any valid tidyselect
selection and/or renaming are supported.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select any number of variables to make the stack</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># the selection order translates into stack order</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">drat</span>, <span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># use any valid tidyselect selection syntax</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"carb"</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-2-3.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># use any valid tidyselect renaming syntax to rename stack panels</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`mpg [units]` <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span>, </span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`weight [tons]` <span class="op">=</span> <span class="va">wt</span>, `speed` <span class="op">=</span> <span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-2-4.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="horizontal-stack">Horizontal stack<a class="anchor" aria-label="anchor" href="#horizontal-stack"></a>
</h4>
<p>Select multiple x variables to stack:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all examples shown in this document work the same way for a horizontal</span></span>
<span><span class="co"># stack, simply switch out the x and y assignments</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="palette-argument">
<code>palette</code> argument<a class="anchor" aria-label="anchor" href="#palette-argument"></a>
</h3>
<p>Set individual plot colors by providing an RColorBrewer palette.
Color definition applies to the color and fill aesthetics as well as the
actual axis colors.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the Set1 RColorBrewer palette</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># likewise for the horizontal stack version</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="color-argument">
<code>color</code> argument<a class="anchor" aria-label="anchor" href="#color-argument"></a>
</h3>
<p>Alternatively, set colors manually by supplying a character vector of
colors:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select any specific colors for each plot</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="remove_na-argument">
<code>remove_na</code> argument<a class="anchor" aria-label="anchor" href="#remove_na-argument"></a>
</h3>
<p>This removes NA values so that lines are not interrupted. When
<code>remove_na</code> is set to <code>FALSE</code>, breaks in lines may
appear due to NA values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># default (NAs are removed so lines are not interrupted)</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="fl">22</span>, wt <span class="op">=</span> <span class="fl">5</span>, qsec <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># explicit `remove_na` = FALSE</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="fl">22</span>, wt <span class="op">=</span> <span class="fl">5</span>, qsec <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    remove_na <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-7-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="both_axes-argument">
<code>both_axes</code> argument<a class="anchor" aria-label="anchor" href="#both_axes-argument"></a>
</h3>
<p>When <code>both_axes = TRUE</code> , the stacked variable axes are
duplicated on both sides of each stacked plot.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vertical stackplot</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    both_axes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Horizontal stackplot</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    both_axes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-8-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="alternate_axes-argument">
<code>alternate_axes</code> argument<a class="anchor" aria-label="anchor" href="#alternate_axes-argument"></a>
</h3>
<p>When <code>alternate_axes = FALSE</code> , the axes for the multiple
variables are kept on the same side of the facets. The default behavior
alternates these axes left/right or top/bottom.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># axes do not alternate:</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    alternate_axes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Horizontal version</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    alternate_axes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-9-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="switch_axes-argument">
<code>switch_axes</code> argument<a class="anchor" aria-label="anchor" href="#switch_axes-argument"></a>
</h3>
<p>Determines whether to switch the stacked axes. Not switching means
that for vertical stacks the plot at the bottom has the y-axis always on
the left side; and for horizontal stacks that the plot on the left has
the x-axis on top. Setting <code>switch_axes = TRUE</code>}, leads to
the opposite. If <code>alternate_axes = TRUE</code> this essentially
switches the order with which the axes alternate (e.g., right/left/right
vs. left/right/left). Note that if <code>both_axes = TRUE</code>,
neither the <code>switch_axes</code> nor <code>alternate_axes</code>
parameter has any effect.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># stacked axis starts on the right</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    switch_axes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># or for the horizontal version, stacked axis</span></span>
<span><span class="co"># starts on the bottom</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    switch_axes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-10-2.png" width="672"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># and in combination with alternate_axes = FALSE</span></span>
<span><span class="co"># all axes on the right</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    alternate_axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    switch_axes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-10-3.png" width="672"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># or all axes on the top</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    alternate_axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    switch_axes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-10-4.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="overlap-argument">
<code>overlap</code> argument<a class="anchor" aria-label="anchor" href="#overlap-argument"></a>
</h3>
<p>Overlap determines the grid overlap between the multiple stacked
plots. <code>1</code> corresponds to fully overlapping (similar to
having a ggplot <code>sec_axis</code> enabled) while <code>0</code> does
not overlap at all.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define any overlap between 0 and 1</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># full overlap</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-11-2.png" width="672"></p>
<div class="section level4">
<h4 id="different-overlaps">Different overlaps<a class="anchor" aria-label="anchor" href="#different-overlaps"></a>
</h4>
<p>Multiple overlap arguments can be supplied with a numeric vector of
numbers between 0 and 1, where each element in the vector corresponds to
the overlap between the <em>n</em> and <em>n+1</em>th overlap value. For
example, for a plot with four stacked panels: <code>qsec</code>,
<code>drat</code>, <code>wt</code>, <code>hp</code>, a vector of
<code>overlap = c(1, 0, 1)</code> indicates that between the first 2
elements (<code>qsec</code> and <code>drat</code>) there is full
overlap. Between <code>drat</code> and <code>wt</code> there is no
overlap (<code>0</code>). Between <code>wt</code> and <code>hp</code>
there is full overlap.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># different overlap between stack panels</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, </span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span>, <span class="va">wt</span>, <span class="va">hp</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#984EA3"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># and the horizontal version</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, </span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span>, <span class="va">wt</span>, <span class="va">hp</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#984EA3"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="shared_axis_size-argument">
<code>shared_axis_size</code> argument<a class="anchor" aria-label="anchor" href="#shared_axis_size-argument"></a>
</h3>
<p>The size of the shared axis determines the size of any shared axes
relative to the grid size of the original ggplot. The size of the shared
axis often needs to be adjusted depending on which aspect ratio is
intended. It is defined as fraction of a full panel, between 0 and
1.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># can be only 10% of a plot size as we're overlapping plots</span></span>
<span>    shared_axis_size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="simplify_shared_axis-argument">
<code>simplify_shared_axis</code> argument<a class="anchor" aria-label="anchor" href="#simplify_shared_axis-argument"></a>
</h3>
<p>Sometimes it’s better just to keep the shared axis on each panel.
This produces something akin to a <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> or
<code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">cowplot::plot_grid()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    simplify_shared_axis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># also goes well with changing `both_axes`, `switch_axes` and/or `alternate_axes`</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    simplify_shared_axis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    alternate_axes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-14-2.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="the-template-argument">The <code>template</code> argument<a class="anchor" aria-label="anchor" href="#the-template-argument"></a>
</h2>
<p>This is the most important argument. It defines which ggplot to use
as the template for all plots in the stack. This can be an actual plot
(just the data will be replaced) or a ggplot that doesn’t have data
associated yet. The possibilities are pretty much endless. Just make
sure to always add the <code>theme_stacked_plot()</code> base theme (you
can modify it more from there on). A few examples below:</p>
<div class="section level3">
<h3 id="theme-modifications">Theme modifications<a class="anchor" aria-label="anchor" href="#theme-modifications"></a>
</h3>
<p>Add any modification to the overlying theme as you see fit.</p>
<p>Here, <code>template</code> allows the user to define that a
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> will serve as the base, with
<code>geom_line</code> as the primary geom. Then,
<code><a href="../reference/theme_stackplot.html">theme_stackplot()</a></code> is applied and custom
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> options are set.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># increase y axis text size</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># increase the panel margins</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        <span class="co"># increase left margin to 20% and top/bottom margins to 10%</span></span>
<span>        plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>l <span class="op">=</span> <span class="fl">0.2</span>, t <span class="op">=</span> <span class="fl">0.1</span>, b <span class="op">=</span> <span class="fl">0.1</span>, unit <span class="op">=</span> <span class="st">"npc"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-15-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="grid-modifications">Grid modifications<a class="anchor" aria-label="anchor" href="#grid-modifications"></a>
</h3>
<p>Modifying the <code>panel.grid</code> argument can create gridlines
for both the stacked variable axes and the shared axis. This can get a
bit cluttered in a plot where <code>overlap = 1</code>.<br></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    template <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"qsec"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"drat"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span></span>
<span>          color <span class="op">=</span> <span class="st">"lightgray"</span>, </span>
<span>          linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>But, this can look reasonable if there is no overlap of the stacked
plats, and/or if the lines are made inconspicuous:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    template <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"qsec"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"drat"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span></span>
<span>          color <span class="op">=</span> <span class="st">"lightgray"</span>, </span>
<span>          linetype <span class="op">=</span> <span class="st">"dotted"</span>, </span>
<span>          linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="other-themes">Other themes<a class="anchor" aria-label="anchor" href="#other-themes"></a>
</h3>
<p>You aren’t bound to our theme’s aesthetic choices :), you can always
add another theme or theme modifications on top of
<code><a href="../reference/theme_stackplot.html">theme_stackplot()</a></code>! Here we add the classic
<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code> to get those nice clean gridlines back, as well
as a panel border.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    template <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"qsec"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"drat"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># give us that good theme!</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="custom-geom-data">Custom geom data<a class="anchor" aria-label="anchor" href="#custom-geom-data"></a>
</h3>
<p>It is possible to use different geoms for different stacked panels.
Here, we use both lines and points. These geoms are defined in the
<code>template</code> argument.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use different geoms for different panels</span></span>
<span><span class="co"># you can refer to y-stack panel variables with `.yvar` and x-stack panel variables with `.xvar`</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    template <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"qsec"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">.yvar</span> <span class="op">==</span> <span class="st">"drat"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="different-plot-elements">Different plot elements<a class="anchor" aria-label="anchor" href="#different-plot-elements"></a>
</h3>
<p>One can also change the geoms in the default theme. Here we use
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path()</a></code> instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> in a
horizontal stack. This is a very common use case because
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code> connects the data points by increasing x-axis
which is not always what we want (for example in oceanographic depth
plots where we want to connect the data points by increasing y-axis
value).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># horizontal stack with default (geom_line())</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># default in template</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the following is the exact same data but using a</span></span>
<span><span class="co"># horizontal stack with "depth-profile" like geom_path()</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># arrange data by the y-axis</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">mpg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># plots data in order</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-20-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="additional-plot-elements">Additional plot elements<a class="anchor" aria-label="anchor" href="#additional-plot-elements"></a>
</h3>
<p>One can also add additional plot elements just as with a normal
ggplot. Here we add a vertical line that is shared across all stacked
plots:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    overlap <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">20</span>, linewidth <span class="op">=</span> <span class="fl">4</span>, color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="axis-modifications">Axis modifications<a class="anchor" aria-label="anchor" href="#axis-modifications"></a>
</h3>
<p>Sometimes secondary axes will still be desired, especially if that
axis is a transformation of an existing one. For example, here, we
create a square root mpg axis that is plotted against the mpg axis. All
this can also be defined in the <code>template</code> argument by adding
a <code>scale_x_continuous</code> argument, just as you would in a
normal ggplot.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add a secondary x axis</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    both_axes <span class="op">=</span> <span class="cn">TRUE</span>, overlap <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>        <span class="co"># change axis name</span></span>
<span>        name <span class="op">=</span> <span class="st">"this is my mpg axis"</span>,</span>
<span>        <span class="co"># this can be the same with dup_axis() or as here have a transformed axis</span></span>
<span>        sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span></span>
<span>          transform <span class="op">=</span> <span class="va">sqrt</span>, </span>
<span>          name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span>, </span>
<span>          breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>Similarly, transformation axes can be introduced such as e.g. a log
axis.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    both_axes <span class="op">=</span> <span class="cn">TRUE</span>, overlap <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"this is my log10 mpg axis"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="additional-aesthetics">Additional aesthetics<a class="anchor" aria-label="anchor" href="#additional-aesthetics"></a>
</h3>
<p>Aesthetics are also defined in the <code>template</code> argument.
Remember, the only parameters that are defined in the stackplot are (i)
the shared axis (in this case, <code>mpg</code> ), (ii) the axes to be
stacked, in this case <code>y = c(wt, qsec, drat)</code>, (iii) any
ggstackplot-specific arguments. All ggplot arguments and aesthetics are
assigned in the <code>template</code> argument.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add aesthetics to the plot</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>,  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    alternate_axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="the-add-argument">The <code>add</code> argument<a class="anchor" aria-label="anchor" href="#the-add-argument"></a>
</h2>
<p>For even more specific plot refinements, the <code>add</code>
argument provides an easy way to add ggplot components to
<strong>specific panels</strong> in the stack plot. A few examples
below:</p>
<div class="section level3">
<h3 id="custom-geoms">Custom geoms<a class="anchor" aria-label="anchor" href="#custom-geoms"></a>
</h3>
<p>Similar to the example <code>custom geom data</code> the
<code>add</code> argument can also be used to add specific geoms
<em>only to specific panels.</em></p>
<p>This takes the form of a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> where each item in the
list is of the form: <code>panel_name = panel_addition</code> where
panel_name is the panel-specific variable and
<code>panel_addition</code> is the item to <code>add</code>
(<code>+</code>) to that panel. <code>add</code> also allows the user to
make additions by index (e.g., first panel, second panel, third panel,
etc.).</p>
<p>Here, we add a <code>geom_line</code> to the <code>qsec</code> panel
and a <code>geom_rect</code> rectangle to the <code>drat</code> panel by
defining these panels in the <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># add:</span></span>
<span>    add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="co"># panel by name</span></span>
<span>      qsec <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>      drat <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>        xmin <span class="op">=</span> <span class="fl">20</span>, xmax <span class="op">=</span> <span class="fl">25</span>, ymin <span class="op">=</span> <span class="fl">3.2</span>, ymax <span class="op">=</span> <span class="fl">4.2</span>, fill <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="custom-themes">Custom themes<a class="anchor" aria-label="anchor" href="#custom-themes"></a>
</h3>
<p>Similarly, custom theme options can be added to specific panels.
Here, we <code>add</code> by panel index:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    <span class="co"># define ggplot template options</span></span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># define panel-specific additions</span></span>
<span>    add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="co"># panel by index</span></span>
<span>      <span class="co"># first panel:</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="co"># second panel:</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span></span>
<span>          color <span class="op">=</span> <span class="st">"lightgray"</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="custom-axes">Custom axes<a class="anchor" aria-label="anchor" href="#custom-axes"></a>
</h3>
<p>The <code>add</code> argument also allows the definition of custom
axes. This is particularly useful if applying functions from the
<code>scales</code> package.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># particularly useful is also the possibility to modify individual scales</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="co"># modify the axis for the second plot</span></span>
<span>      drat <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"$$ drat"</span>,  labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">label_dollar</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="legend-positioning">Legend positioning<a class="anchor" aria-label="anchor" href="#legend-positioning"></a>
</h3>
<p>Another example of theme modification is the use of the `add`
argument to specify legend positioning.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>,  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># switch legend position for middle plot</span></span>
<span>    add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>qsec <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>,  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span>, <span class="va">drat</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span><span class="op">)</span>,</span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># remove the legends, then...</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>, </span>
<span>    <span class="co"># ... re-include the middle panel legend on the plot</span></span>
<span>    <span class="co"># with some additional styling</span></span>
<span>    add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      qsec <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>          <span class="co"># define legend relative position in x,y:</span></span>
<span>          legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.9</span><span class="op">)</span>, </span>
<span>          <span class="co"># other legend stylistic changes:</span></span>
<span>          legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>          legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>          legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span></span>
<span>            color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"gray90"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          legend.direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"VS"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-28-2.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="putting-it-all-together">Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example from the README with economics data bundled with ggplot2</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/economics.html" class="external-link">economics</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">ggstackplot</a></span><span class="op">(</span></span>
<span>    <span class="co"># define shared x axis</span></span>
<span>    x <span class="op">=</span> <span class="va">date</span>, </span>
<span>    <span class="co"># define the stacked y axes</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pce</span>, <span class="va">pop</span>, <span class="va">psavert</span>, <span class="va">unemploy</span><span class="op">)</span>,</span>
<span>    <span class="co"># pick the RColorBrewer Dark2 palette (good color contrast)</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    <span class="co"># overlay the pce &amp; pop plots (1), then make a full break (0) to the once</span></span>
<span>    <span class="co"># again overlaye psavert &amp; unemploy plots (1)</span></span>
<span>    overlap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># switch axes so unemploy and psavert are on the side where they are </span></span>
<span>    <span class="co"># highest, respectively - not doing this here by changing the order of y</span></span>
<span>    <span class="co"># because we want pop and unemploy on the same side</span></span>
<span>    switch_axes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># make shared axis space a bit smaller</span></span>
<span>    shared_axis_size <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    <span class="co"># provide a base plot with shared graphics eelements among all plots</span></span>
<span>    template <span class="op">=</span> </span>
<span>      <span class="co"># it's a ggplot</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># use a line plot for all</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># we want the default stackplot theme</span></span>
<span>      <span class="fu"><a href="../reference/theme_stackplot.html">theme_stackplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># add custom theme modifications, such as text size</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># make the shared axis a date axis</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span><span class="st">"year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># include y=0 for all plots to contextualize data better</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="co"># add plot specific elements</span></span>
<span>    add <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        pce <span class="op">=</span> </span>
<span>          <span class="co"># show pce in trillions of dollars</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"personal consumption expenditures"</span>, </span>
<span>            <span class="co"># always keep the secondary axis duplicated so ggstackplot can</span></span>
<span>            <span class="co"># manage axis placement for you</span></span>
<span>            sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            <span class="co"># labeling function for the dollar units</span></span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"$%.1f T"</span>, <span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>          <span class="op">)</span>,</span>
<span>        pop <span class="op">=</span> </span>
<span>          <span class="co"># show population in millions</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"population"</span>, sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.0f M"</span>, <span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>        psavert <span class="op">=</span> </span>
<span>          <span class="co"># savings is in %</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"personal savings rate"</span>, sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>          <span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="co"># show data points in addition to line</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        unemploy <span class="op">=</span> </span>
<span>          <span class="co"># unemploy in millions</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>            <span class="st">"unemployed persons"</span>, sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.0f M"</span>, <span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span>          <span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="co"># show data points in addition to line</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="advanced">Advanced<a class="anchor" aria-label="anchor" href="#advanced"></a>
</h2>
<p>Instead of calling <code><a href="../reference/ggstackplot.html">ggstackplot()</a></code> to make a plot, you can
also use <code><a href="../reference/ggstackplot.html">prepare_stackplot()</a></code> and
<code><a href="../reference/ggstackplot.html">assemble_stackplot()</a></code> to separate the two main steps of
making a ggstackplot. <code><a href="../reference/ggstackplot.html">prepare_stackplot()</a></code> provides a tibble
with all the plot components that can be modified directly in the tibble
if so desired before assembling the plot with
<code><a href="../reference/ggstackplot.html">assemble_stackplot()</a></code>. Usuallyt this is not necessary
because the combination of the <code>template</code> and
<code>add</code> parameters in <code><a href="../reference/ggstackplot.html">ggstackplot()</a></code> provides the
same kind of flexibility as modifying plot elements in the plot
tibble.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prep plot</span></span>
<span><span class="va">plot_prep</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ggstackplot.html">prepare_stackplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># show plot tibble</span></span>
<span><span class="va">plot_prep</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   .var  config           data               plot   theme   add   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> wt    <span style="color: #949494;">&lt;tibble [1 × 9]&gt;</span> <span style="color: #949494;">&lt;tibble [32 × 11]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>   <span style="color: #949494;">&lt;theme&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> qsec  <span style="color: #949494;">&lt;tibble [1 × 9]&gt;</span> <span style="color: #949494;">&lt;tibble [32 × 11]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>   <span style="color: #949494;">&lt;theme&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span></span>
<span><span class="co"># modify plot tibble</span></span>
<span><span class="va">plot_prep</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">drat</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot_prep</span><span class="op">$</span><span class="va">theme</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assemble stackplot</span></span>
<span><span class="va">plot_prep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ggstackplot.html">assemble_stackplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggstackplot_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kopf, Tristan Caro, Jamie McFarlin, Jon Raberg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
